# August 2020

## August 20th

What's the best way to build a blog for Elisa and I? Somehow the answer to that question last year was to use Wordpress as a CMS and [Gatsby](https://www.gatsbyjs.org/) to consume it and spit out a 'static' website. The resulting [lightsandclockwork.xyz](lightsandclockwork.xyz/) worked for the most part but every time I had to step into javascript-land to work in it I started pulling my hair out. In the end I essentially stopped working on it entirely and felt guilty that I'd failed myself and Elisa in building us a real web presence.

But today is a new day and I'm going to make the website using Clojure like I should have done in the first place ðŸ˜„

So we have a Wordpress site and I've installed these plugins:

 - [WPGraphQL](https://github.com/wp-graphql/wp-graphql)
  - adds a `/graphql` endpoint to our wordpress site
 - [WPGraphiQL](https://github.com/wp-graphql/wp-graphiql)
  - adds the GraphiQL IDE to our wordpress site's internal dashboard

Then let's use [venia](https://github.com/Vincit/venia) to construct a GraphQL query and [clj-http-lite](https://github.com/martinklepsch/clj-http-lite) to send a POST request:

```clj
(ns site.fetch
  (:require
   [clj-http.lite.client :as client]
   [venia.core :as v]))

(def url-q
  (v/graphql-query {:venia/queries [[:generalSettings
                                     [:url]]]}))

(client/post "https://<<OURWPSITE>>/graphql"
             {:content-type :json
              :accept :json
              :body (str "{\"query\": \"" url-q "\"}")})

```

And we got back a 200 response with the body `"{\"data\":{\"generalSettings\":{\"url\":\"https:\\/\\/<<OURWPSITE>>\"}}}"`, success!
